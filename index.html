<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ColorPedia - Find Your Perfect Color & Hex Code</title>
  <meta name="description" content="ColorPedia: Your ultimate guide to discovering, searching, and exploring a vast collection of color names and their hex codes. Find the perfect color for your design projects, websites, and art. Features dark mode, neon effects, and gradient generator.">
  <meta name="keywords" content="color, hex code, color names, color picker, web colors, design, palette, ColorPedia, color search, HTML colors, CSS colors, RGB values, color converter, UI design, UX design, graphic design, color theory, glassmorphism, dark mode, neon effect, frontend development, color tools, gradient generator">
  <meta name="author" content="Sobuj Islam">
  <meta name="robots" content="index, follow"> <meta property="og:title" content="ColorPedia - Discover & Search Colors with Hex Codes">
  <meta property="og:description" content="Explore a comprehensive database of colors, find hex codes, generate gradients, and get inspired for your next project with ColorPedia.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://sobuj21.github.io/colorpedia"> <meta property="og:image" content="https://sobuj21.github.io/colorpedia-preview.jpg"> <meta property="og:image:alt" content="ColorPedia Interface showing color cards">
  <meta property="og:site_name" content="ColorPedia">
  <meta property="og:locale" content="en_US">

  <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:title" content="ColorPedia - Your Go-To Color & Hex Code Finder">
  <meta name="twitter:description" content="Quickly search, discover color names, hex codes, and generate gradients with ColorPedia. Perfect for designers and developers.">
  <meta name="twitter:image" content="https://sobuj21.github.io/colorpedia-twitter-card.jpg"> <meta name="twitter:image:alt" content="A vibrant display of color swatches from ColorPedia">
  <style>
    :root {
      /* Light Mode Variables */
      --bg-gradient: linear-gradient(135deg, #f5f7fa, #c3cfe2);
      --text-primary: #333;
      --text-secondary: #555;
      
      --h1-text-color: #000000; 
      --h1-neon-glow-color: rgba(0, 0, 0, 0.5); 
      --h1-neon-glow-color-outer: rgba(0, 0, 0, 0.3);

      --search-section-bg: rgba(255, 255, 255, 0.15);
      --search-section-border: rgba(255, 255, 255, 0.2);
      --search-section-shadow: 0 6px 20px rgba(31, 38, 135, 0.1);
      --search-neon-glow-color: rgba(0, 123, 255, 0.5);
      --search-box-bg: rgba(255, 255, 255, 0.4);
      --search-box-border: rgba(220, 220, 220, 0.4);
      --search-box-text: #333;
      --search-box-placeholder: #777;
      --search-box-focus-border: #007bff;
      --search-box-focus-bg: rgba(255, 255, 255, 0.7);
      
      --search-btn-bg: #0056b3; 
      --search-btn-hover-bg: #004494; 
      --search-btn-text: white;

      --card-bg: rgba(255, 255, 255, 0.3);
      --card-border: rgba(255, 255, 255, 0.4);
      --card-shadow: 0 5px 20px rgba(0,0,0,0.08);
      --card-hover-bg: rgba(255, 255, 255, 0.45);
      --card-text-strong: #34495e;
      --card-text-hex: #525252;
      --copy-btn-bg: rgba(236, 240, 241, 0.7);
      --copy-btn-border: rgba(189, 195, 199, 0.7);
      --copy-btn-icon-fill: #333;
      --message-bg: rgba(255, 255, 255, 0.15);
      --message-border: rgba(255, 255, 255, 0.2);
      --message-text: #5a6870;

      --footer-bg: rgba(255, 255, 255, 0.1);
      --footer-border-top: transparent;
      --footer-text: #4a5568;
      --footer-link: #007bff;
      --footer-link-hover: #0056b3;
      --footer-neon-glow-color: rgba(0, 123, 255, 0.55);
      --footer-base-shadow-for-neon: 0 -2px 8px rgba(0,0,0,0.07);

      --toggle-bg: #555;
      --toggle-icon-fill: #fff;

      --modal-bg: #ffffff;
      --modal-text-primary: #333;
      --modal-text-secondary: #555;
      --modal-border-color: #ddd;
      --modal-copy-btn-bg: #f0f0f0;
      --modal-copy-btn-hover-bg: #e0e0e0;
      --modal-copy-btn-icon-fill: #333;
      --palette-section-bg: #f9f9f9;
      --accessibility-section-bg: #f9f9f9;
      --status-pass-color: #28a745;
      --status-fail-color: #dc3545;
      --export-btn-bg: #e9ecef;
      --export-btn-text: #212529; 
      --export-btn-hover-bg: #dee2e6;
    }

    body.dark-mode {
      --bg-gradient: linear-gradient(135deg, #232526, #414345);
      --text-primary: #e0e0e0;
      --text-secondary: #b0b0b0;

      --h1-text-color: #FFFFFF; 
      --h1-neon-glow-color: rgba(255, 255, 255, 0.7); 
      --h1-neon-glow-color-outer: rgba(255, 255, 255, 0.5);
      
      --search-section-bg: rgba(0, 0, 0, 0.2);
      --search-section-border: rgba(255, 255, 255, 0.1);
      --search-section-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
      --search-neon-glow-color: rgba(23, 162, 184, 0.6);
      --search-box-bg: rgba(0, 0, 0, 0.25);
      --search-box-border: rgba(255, 255, 255, 0.15);
      --search-box-text: #f0f0f0;
      --search-box-placeholder: #aaa;
      --search-box-focus-border: #17a2b8;
      --search-box-focus-bg: rgba(0, 0, 0, 0.35);

      --search-btn-bg: #107E8F; 
      --search-btn-hover-bg: #0C6776; 
      --search-btn-text: #FFFFFF; 
      
      --card-bg: rgba(40, 40, 40, 0.4);
      --card-border: rgba(255, 255, 255, 0.1);
      --card-shadow: 0 5px 20px rgba(0,0,0,0.2);
      --card-hover-bg: rgba(50, 50, 50, 0.55);
      --card-text-strong: #e0e0e0;
      --card-text-hex: #b0b0b0;
      --copy-btn-bg: rgba(60, 60, 60, 0.7);
      --copy-btn-border: rgba(100, 100, 100, 0.7);
      --copy-btn-icon-fill: #e0e0e0;
      --message-bg: rgba(0, 0, 0, 0.2);
      --message-border: rgba(255, 255, 255, 0.1);
      --message-text: #b0b0b0;

      --footer-bg: rgba(10, 10, 20, 0.15);
      --footer-text: #cbd5e0;
      --footer-link: #17a2b8;
      --footer-link-hover: #20c997;
      --footer-neon-glow-color: rgba(23, 162, 184, 0.7);
      --footer-base-shadow-for-neon: 0 -2px 8px rgba(0,0,0,0.25);
      
      --toggle-bg: #ccc;
      --toggle-icon-fill: #333;

      --modal-bg: #2c3340; 
      --modal-text-primary: #e0e0e0;
      --modal-text-secondary: #b0b0b0;
      --modal-border-color: #4a5568;
      --modal-copy-btn-bg: #3a4150;
      --modal-copy-btn-hover-bg: #4a5568;
      --modal-copy-btn-icon-fill: #e0e0e0;
      --palette-section-bg: #232934;
      --accessibility-section-bg: #232934;
      --status-pass-color: #34D399; 
      --status-fail-color: #F87171; 
      --export-btn-bg: #374151;
      --export-btn-text: #d1d5db; 
      --export-btn-hover-bg: #4b5563;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-gradient);
      margin: 0;
      padding: 15px;
      text-align: center;
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      transition: background 0.3s ease, color 0.3s ease;
      box-sizing: border-box;
      position: relative; /* Added for z-index context if needed */
      overflow-x: hidden; /* Prevent horizontal scroll from effects */
    }
    h1 {
      color: var(--h1-text-color); 
      font-size: 2.5em;
      margin-bottom: 10px;
      font-weight: 600;
      letter-spacing: -0.5px;
      cursor: pointer;
      text-shadow:
        0 0 4px var(--h1-neon-glow-color),
        0 0 8px var(--h1-neon-glow-color),
        0 0 12px var(--h1-neon-glow-color-outer);
      transition: text-shadow 0.3s ease, color 0.3s ease; 
      position: relative; /* Ensure H1 is above sky effects if z-index is an issue */
      z-index: 2; 
    }
    p {
      color: var(--text-secondary);
      font-size: 0.95em;
      line-height: 1.5;
      position: relative; /* Ensure p is above sky effects */
      z-index: 2;
    }

    #search-section {
      margin: 20px auto;
      display: flex;  
      flex-direction: column;
      gap: 10px;
      align-items: stretch; 
      max-width: 650px;
      width: 100%;
      background: var(--search-section-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 15px; 
      border: 1px solid transparent;  
      box-shadow:
        var(--search-section-shadow),  
        0 0 8px var(--search-neon-glow-color),
        0 0 15px var(--search-neon-glow-color),  
        0 0 20px var(--search-neon-glow-color);  
      transition: background 0.3s ease, box-shadow 0.3s ease;
      box-sizing: border-box;
      position: relative; /* Ensure search section is above sky effects */
      z-index: 2;
    }

    #search-input-container {
        position: relative;
        display: flex; 
        flex-grow: 1; 
    }

    #search-box {
      padding: 15px 18px;
      padding-right: 40px; 
      flex-grow: 1;  
      font-size: 1em;
      border: 1px solid var(--search-box-border);  
      border-radius: 12px;
      outline: none;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
      transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s, color 0.3s ease;
      background-color: var(--search-box-bg);
      color: var(--search-box-text);
      width: 100%; 
      box-sizing: border-box; 
    }
    #search-box::placeholder {
        color: var(--search-box-placeholder);
        opacity: 0.8;
    }
    #search-box:focus {
      border-color: var(--search-box-focus-border);
      background-color: var(--search-box-focus-bg);
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
      color: var(--search-box-text);
    }

    #paste-btn {
        position: absolute;
        right: 6px; 
        top: 50%;
        transform: translateY(-50%);
        background: transparent;
        border: none;
        padding: 6px; 
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px; 
        color: var(--search-box-placeholder); 
        transition: background-color 0.2s ease, color 0.2s ease;
    }
    #paste-btn svg {
        width: 16px;
        height: 16px;
        fill: currentColor; 
    }
    #paste-btn:hover {
        background-color: rgba(0,0,0,0.05); 
        color: var(--search-box-text);
    }
    body.dark-mode #paste-btn:hover {
        background-color: rgba(255,255,255,0.1);
    }

    #search-btn {
      padding: 15px 20px;
      font-size: 1em;
      border: 1px solid var(--search-btn-bg);  
      background-color: var(--search-btn-bg);
      color: var(--search-btn-text);
      border-radius: 12px;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s, border-color 0.3s;
      font-weight: 500;
      flex-shrink: 0;  
      width: 100%; 
    }
    #search-btn:hover {
      background-color: var(--search-btn-hover-bg);
      border-color: var(--search-btn-hover-bg);
      transform: translateY(-1px);
    }

    #color-display {
      margin-top: 25px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      padding-bottom: 80px; 
      flex-grow: 1;
      min-height: 240px; 
      position: relative; /* Ensure color display is above sky effects */
      z-index: 2;
    }
    .color-card {
      background: var(--card-bg);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--card-border);
      padding: 12px;
      margin: 0;    
      border-radius: 10px;
      width: calc(50% - 10px); 
      max-width: 160px;
      box-shadow: var(--card-shadow);
      transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
      display: flex;
      flex-direction: column;
      text-align: left;
      box-sizing: border-box;
    }
    .color-card:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
      background: var(--card-hover-bg);
    }
    .color-box, .color-info strong {
        cursor: pointer;
    }
    .color-box {
      height: 60px;
      border-radius: 6px;
      margin-bottom: 10px;
      border: 1px solid rgba(0,0,0,0.05);  
    }
    .color-info {
      font-size: 0.85em;
    }
    .color-info strong {
      font-size: 1em;
      color: var(--card-text-strong);
      display: block;
      margin-bottom: 3px;
    }
    .color-info .hex-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 3px;
    }
    .color-info .hex-container span {
      color: var(--card-text-hex);
      font-family: 'Courier New', Courier, monospace;
      font-size:0.9em;
      word-break: break-all;
    }
    .copy-hex-btn { 
      background: var(--copy-btn-bg);
      border: 1px solid var(--copy-btn-border);
      border-radius: 4px;
      cursor: pointer;
      padding: 3px 5px;
      margin-left: 5px;
      line-height: 1;  
      transition: background-color 0.2s, color 0.2s, border-color 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .copy-hex-btn svg {
      fill: var(--copy-btn-icon-fill);
      display: block;  
      width: 12px;
      height: 12px;
    }
    .copy-hex-btn:hover {
      background-color: rgba(223, 228, 231, 0.9);
      border-color: #adb5bd;
    }
    body.dark-mode .copy-hex-btn:hover {
      background-color: rgba(80, 80, 80, 0.9);
      border-color: #777;
    }
    .copy-hex-btn.copied, .copy-detail-btn.copied, .copy-palette-color-btn.copied, .export-palette-btn.copied, #copy-gradient-css-btn.copied { 
      background-color: #2ecc71 !important;  
      color: white !important;
      border-color: #27ae60 !important;
    }
    .copy-hex-btn.copied svg, .copy-detail-btn.copied svg, .copy-palette-color-btn.copied svg {
      display: none;
    }
     .export-palette-btn.copied, #copy-gradient-css-btn.copied { 
        font-size: 0.8em; 
    }
    .copy-hex-btn.error, .copy-detail-btn.error, .copy-palette-color-btn.error, .export-palette-btn.error, #copy-gradient-css-btn.error { 
      background-color: #e74c3c !important;
      color: white !important;
      border-color: #c0392b !important;
    }
    .copy-hex-btn.error svg, .copy-detail-btn.error svg, .copy-palette-color-btn.error svg {
      display: none;
    }
    .export-palette-btn.error, #copy-gradient-css-btn.error {
        font-size: 0.8em;
    }

    .no-results, .initial-message {
      font-size: 1em;
      color: var(--message-text);
      margin-top: 20px;
      width: 100%;  
      background: var(--message-bg);
      backdrop-filter: blur(5px);
      -webkit-backdrop-filter: blur(5px);
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--message-border);
      box-sizing: border-box;  
    }
      .initial-message {  
        margin-bottom: 15px;
    }

    .tool-section {
      margin: 30px auto;
      background: var(--search-section-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 20px;
      border: 1px solid var(--search-section-border);
      box-shadow: var(--search-section-shadow),
                  0 0 8px var(--search-neon-glow-color), 
                  0 0 15px var(--search-neon-glow-color),  
                  0 0 20px var(--search-neon-glow-color);
      max-width: 650px;
      width: 100%;
      box-sizing: border-box;
      text-align: left;
      position: relative; /* Ensure tool section is above sky effects */
      z-index: 2;
    }
    .tool-section h2 {
      color: var(--h1-text-color);
      text-align: center;
      margin-top: 0;
      margin-bottom: 25px;
      font-size: 1.8em;
      font-weight: 600;
      text-shadow:
        0 0 3px var(--h1-neon-glow-color), 
        0 0 6px var(--h1-neon-glow-color),
        0 0 9px var(--h1-neon-glow-color-outer);
    }
    .gradient-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
      gap: 15px;
      margin-bottom: 20px;
    }
    .gradient-controls div { 
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .gradient-controls label {
      color: var(--text-secondary);
      font-size: 0.9em;
      font-weight: 500;
    }
    .gradient-controls input[type="color"],
    .gradient-controls select {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--search-box-border);
      background-color: var(--search-box-bg);
      color: var(--search-box-text);
      font-size: 0.95em;
      box-sizing: border-box;
      width: 100%; 
    }
    .gradient-controls input[type="color"] {
      height: 45px; 
      padding: 5px; 
    }
    #gradient-preview {
      width: 100%;
      height: 150px; 
      border: 1px solid var(--card-border); 
      border-radius: 8px;
      margin-top: 15px;
      margin-bottom: 15px;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
    }
    .gradient-output {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    .gradient-output label {
      color: var(--text-secondary);
      font-size: 0.9em;
      font-weight: 500;
    }
    .gradient-output textarea {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--search-box-border);
      background-color: var(--search-box-bg);
      color: var(--search-box-text);
      font-family: 'Courier New', Courier, monospace;
      font-size: 0.9em;
      resize: vertical;
      min-height: 60px;
      box-sizing: border-box;
    }
    #copy-gradient-css-btn {
      padding: 10px 18px;
      font-size: 0.95em;
      border: 1px solid var(--search-btn-bg); 
      background-color: var(--search-btn-bg);
      color: var(--search-btn-text);
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
      font-weight: 500;
      align-self: flex-start; 
    }
    #copy-gradient-css-btn:hover {
      background-color: var(--search-btn-hover-bg);
      transform: translateY(-1px);
    }

    footer {
      background: var(--footer-bg);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border: 1px solid transparent;  
      color: var(--footer-text);
      padding: 15px 20px;
      padding-bottom: 60px; 
      margin-top: auto;  
      font-size: 0.85em;
      width: 100%;
      box-sizing: border-box;
      border-radius: 15px; 
      position: relative; 
      transition: background 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
      box-shadow:
        var(--footer-base-shadow-for-neon),  
        0 0 8px var(--footer-neon-glow-color),
        0 0 15px var(--footer-neon-glow-color),
        0 0 20px var(--footer-neon-glow-color);
      z-index: 2; /* Ensure footer is above sky effects */
    }
    footer p {
      margin: 6px 0;
      color: var(--footer-text);  
      line-height: 1.4;
    }
    footer a {
      color: var(--footer-link);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s, text-shadow 0.3s;
    }
    footer a:hover {
      color: var(--footer-link-hover);
      text-shadow: 0 0 5px var(--footer-link-hover-shadow, rgba(130, 192, 230, 0.5));
    }
    body.dark-mode footer a:hover {
        --footer-link-hover-shadow: rgba(169, 214, 245, 0.6);  
    }

    #dark-mode-toggle {
      position: absolute; /* Changed from fixed to absolute relative to footer */
      top: 15px;
      right: 15px;
      background: var(--toggle-bg);
      color: var(--toggle-icon-fill);  
      border: none;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.15);
      transition: background-color 0.3s ease, transform 0.2s ease;
      z-index: 1001; /* Ensure it's above footer content but respects footer's z-index */
    }
    #dark-mode-toggle:hover {
      transform: scale(1.08);
    }
    #dark-mode-toggle svg {
      width: 18px;
      height: 18px;
      fill: var(--toggle-icon-fill);  
      transition: fill 0.3s ease;
    }

    #scroll-to-top-btn {
      position: absolute; /* Changed from fixed to absolute relative to footer */
      top: 60px; 
      right: 15px; 
      background: var(--toggle-bg);
      color: var(--toggle-icon-fill);
      border: none;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.15);
      transition: background-color 0.3s ease, transform 0.2s ease, opacity 0.3s ease, visibility 0.3s ease;
      opacity: 0;
      visibility: hidden;
      z-index: 1000; /* Ensure it's above footer content */
    }
    #scroll-to-top-btn.visible {
        opacity: 1;
        visibility: visible;
    }
    #scroll-to-top-btn:hover {
      transform: scale(1.08);
    }
    #scroll-to-top-btn svg {
      width: 18px;
      height: 18px;
      fill: var(--toggle-icon-fill);
    }

    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(5px);
        -webkit-backdrop-filter: blur(5px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
        padding: 15px; 
        box-sizing: border-box;
    }
    .modal-overlay.visible {
        opacity: 1;
        visibility: visible;
    }
    .modal-content {
        background-color: var(--modal-bg);
        padding: 20px; 
        border-radius: 12px;
        box-shadow: 0 5px 25px rgba(0,0,0,0.2);
        width: 100%; 
        max-width: 500px; 
        position: relative;
        text-align: left;
        transform: scale(0.95);
        transition: transform 0.3s ease;
        max-height: 90vh; 
        overflow-y: auto; 
    }
    .modal-overlay.visible .modal-content {
        transform: scale(1);
    }
    .modal-close-btn {
        position: absolute;
        top: 10px;
        right: 15px;
        background: none;
        border: none;
        font-size: 2em;
        color: var(--modal-text-secondary);
        cursor: pointer;
        line-height: 1;
        padding: 0;
    }
    .modal-close-btn:hover {
        color: var(--modal-text-primary);
    }
    .modal-color-swatch {
        width: 100%;
        height: 100px; 
        border-radius: 8px;
        margin-bottom: 15px; 
        border: 1px solid var(--modal-border-color);
    }
    .modal-content h2 { 
        color: var(--modal-text-primary);
        font-size: 1.6em; 
        margin-top: 0;
        margin-bottom: 15px;
        font-weight: 600;
    }
    .modal-color-details .detail-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px; 
        padding: 6px 0; 
        border-bottom: 1px solid var(--modal-border-color);
    }
    .modal-color-details .detail-item:last-child {
        border-bottom: none;
        margin-bottom: 0;
    }
    .modal-color-details .detail-item span:first-child { 
        color: var(--modal-text-secondary);
        font-weight: 500;
        min-width: 40px; 
    }
    .modal-color-details .detail-item span:nth-child(2) { 
        color: var(--modal-text-primary);
        font-family: 'Courier New', Courier, monospace;
        font-size: 0.95em;
        word-break: break-all;
        flex-grow: 1;
        margin: 0 10px;
    }
    .copy-detail-btn { 
        background: var(--modal-copy-btn-bg);
        border: 1px solid var(--modal-border-color);
        color: var(--modal-copy-btn-icon-fill);
        border-radius: 6px;
        cursor: pointer;
        padding: 6px 8px;
        margin-left: 8px;
        line-height: 1;  
        transition: background-color 0.2s, border-color 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }
    .copy-detail-btn svg {
        fill: var(--modal-copy-btn-icon-fill);
        width: 14px;
        height: 14px;
    }
    .copy-detail-btn:hover {
        background-color: var(--modal-copy-btn-hover-bg);
    }

    .modal-palettes-container, .modal-accessibility-container { 
        margin-top: 25px;
        padding-top: 15px;
        border-top: 1px solid var(--modal-border-color);
    }
    .modal-palettes-container > h3, .modal-accessibility-container > h3 { 
        font-size: 1.3em;
        color: var(--modal-text-primary);
        margin-bottom: 15px;
        font-weight: 600;
    }
    .palette-section {
        margin-bottom: 20px;
        background-color: var(--palette-section-bg);
        padding: 10px;
        border-radius: 8px;
    }
    .palette-section h4 { 
        font-size: 1em;
        color: var(--modal-text-secondary);
        margin-top: 0;
        margin-bottom: 10px;
        font-weight: 500;
        border-bottom: 1px solid var(--modal-border-color);
        padding-bottom: 5px;
    }
    .palette-swatches {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
    }
    .palette-swatch-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
        padding: 5px;
        border-radius: 6px;
        border: 1px solid var(--modal-border-color);
        background-color: var(--modal-bg); 
        min-width: 70px; 
    }
    .palette-swatch-item .palette-color-box {
        width: 50px;
        height: 50px;
        border-radius: 4px;
        border: 1px solid rgba(0,0,0,0.1);
        cursor: default; 
    }
    .palette-swatch-item .palette-hex-code {
        font-family: 'Courier New', Courier, monospace;
        font-size: 0.75em;
        color: var(--modal-text-secondary);
        margin-top: 2px;
    }
    .copy-palette-color-btn {
        background: var(--modal-copy-btn-bg);
        border: 1px solid var(--modal-border-color);
        color: var(--modal-copy-btn-icon-fill);
        border-radius: 4px;
        cursor: pointer;
        padding: 3px 5px;
        line-height: 1;
        transition: background-color 0.2s, border-color 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 2px; 
    }
    .copy-palette-color-btn svg {
        fill: var(--modal-copy-btn-icon-fill);
        width: 10px; 
        height: 10px;
    }
    .copy-palette-color-btn:hover {
        background-color: var(--modal-copy-btn-hover-bg);
    }
    .palette-export-options {
        margin-top: 10px;
        display: flex;
        gap: 8px;
        justify-content: flex-start;
    }
    .export-palette-btn {
        background-color: var(--export-btn-bg);
        color: var(--export-btn-text);
        border: 1px solid var(--modal-border-color);
        padding: 5px 10px;
        font-size: 0.8em;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.2s ease;
    }
    .export-palette-btn:hover {
        background-color: var(--export-btn-hover-bg);
    }
    
    .contrast-check-item {
        background-color: var(--accessibility-section-bg);
        padding: 10px 15px;
        border-radius: 8px;
        margin-bottom: 15px;
    }
    .contrast-check-item h4 {
        font-size: 1em;
        color: var(--modal-text-secondary);
        margin-top: 0;
        margin-bottom: 8px;
        font-weight: 500;
    }
    .contrast-check-item p {
        font-size: 0.9em;
        color: var(--modal-text-primary);
        margin: 0 0 8px 0;
    }
    .contrast-check-item .contrast-ratio-value {
        font-weight: bold;
    }
    .compliance-results {
        list-style: none;
        padding: 0;
        margin: 0;
        font-size: 0.85em;
    }
    .compliance-results li {
        margin-bottom: 4px;
        color: var(--modal-text-secondary);
    }
    .compliance-results .status {
        font-weight: bold;
    }
    .compliance-results .status.pass {
        color: var(--status-pass-color);
    }
    .compliance-results .status.fail {
        color: var(--status-fail-color);
    }

    /* Added CSS for the footer star logo */
    #footer-star-link {
        position: absolute;
        left: 20px; 
        top: 50%;
        transform: translateY(-50%);
        z-index: 10; 
        text-decoration: none;
    }

    #footer-3d-star {
        font-size: 28px; 
        color: #FFD700; /* Gold color */
        text-shadow: 0 0 5px #FFD700, 0 0 10px #FFD700, 0 0 15px #FFEA00, 0 0 20px #FFEA00; /* Glow effect */
        transition: transform 0.3s ease, text-shadow 0.3s ease;
    }

    #footer-3d-star:hover {
        transform: scale(1.1) translateY(-50%); /* Maintain vertical alignment on scale */
        text-shadow: 0 0 8px #FFD700, 0 0 15px #FFD700, 0 0 25px #FFEA00, 0 0 35px #FFEA00; /* Enhanced glow */
    }
    /* End of added CSS for footer star logo */

    /* --- NEW SKY EFFECTS CSS --- */
    #sky-effects-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none; /* Allows clicks to pass through */
        z-index: 0; /* Behind main content but above body background */
        overflow: hidden; /* Prevent scrollbars from effects */
    }

    .shooting-star {
        position: absolute;
        width: 80px; /* Length of the star's tail */
        height: 2px; /* Thickness of the star */
        background: linear-gradient(to right, rgba(255, 255, 255, 0.8), transparent);
        border-radius: 50%;
        opacity: 0;
        animation-name: shoot;
        animation-timing-function: linear;
        animation-iteration-count: 1; /* Play once then remove */
        will-change: transform, opacity;
    }

    @keyframes shoot {
        0% {
            opacity: 1;
            transform: translateX(var(--start-x)) translateY(var(--start-y)) rotate(var(--angle)) scaleX(1);
        }
        70% {
            opacity: 1;
        }
        100% {
            opacity: 0;
            transform: translateX(var(--end-x)) translateY(var(--end-y)) rotate(var(--angle)) scaleX(2); /* Make tail slightly longer as it fades */
        }
    }

    .aircraft {
        position: absolute;
        color: #555; /* Aircraft color for light mode */
        font-size: 24px; /* Adjust size as needed */
        animation: flyAcross 20s linear infinite;
        will-change: transform;
        display: flex; /* For potential future multi-part aircraft SVG */
        align-items: center;
        transform: translateY(10vh); /* Initial Y position */
    }
    body.dark-mode .aircraft {
        color: #AAA; /* Aircraft color for dark mode */
    }

    @keyframes flyAcross {
        0% {
            transform: translateX(-10vw) translateY(10vh) rotate(5deg);
        }
        25% {
             transform: translateX(25vw) translateY(15vh) rotate(0deg);
        }
        50% {
            transform: translateX(60vw) translateY(12vh) rotate(-5deg);
        }
        75% {
             transform: translateX(90vw) translateY(18vh) rotate(2deg);
        }
        100% {
            transform: translateX(110vw) translateY(15vh) rotate(5deg);
        }
    }
    
    .smoke-particle {
        position: absolute;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        opacity: 0.7;
        animation: fadeAndDrift 2s ease-out forwards;
        will-change: transform, opacity;
    }

    @keyframes fadeAndDrift {
        0% {
            transform: scale(1) translateY(0);
            opacity: 0.7;
        }
        100% {
            transform: scale(2.5) translateY(-30px); /* Drifts up and expands */
            opacity: 0;
        }
    }

    .night-star {
        position: absolute;
        width: 1px;
        height: 1px;
        background-color: white;
        border-radius: 50%;
        box-shadow: 0 0 3px white, 0 0 6px white;
        animation: twinkle 3s infinite alternate;
        display: none; /* Hidden by default */
        opacity: 0;
        transition: opacity 1s ease-in-out; /* For fade in with dark mode */
    }
     body.dark-mode .night-star.visible { /* Use a class to control visibility for smoother transition */
        display: block;
        opacity: 1; /* Initial opacity for twinkle animation */
    }


    @keyframes twinkle {
        0% { opacity: 0.3; transform: scale(0.8); }
        50% { opacity: 1; transform: scale(1.2); }
        100% { opacity: 0.3; transform: scale(0.8); }
    }
    /* --- END OF NEW SKY EFFECTS CSS --- */


    @media (min-width: 380px) {
        /* No specific changes */
    }

    @media (min-width: 600px) {
      body { padding: 20px; }
      h1 { font-size: 3em; }
      #search-section { flex-direction: row; gap: 12px; padding: 10px 15px; align-items: center; }
      #search-box { font-size: 1.1em; padding: 18px 22px; padding-right: 48px; border-radius: 18px;}
      #paste-btn { right: 8px; padding: 7px; }
      #paste-btn svg { width: 18px; height: 18px; }
      #search-btn { font-size: 1.1em; padding: 18px 25px; border-radius: 18px; width: auto; }
      .color-card { width: calc(33.333% - 14px); max-width: 180px; padding: 15px; border-radius: 12px; }
      .color-box { height: 70px; border-radius: 8px; margin-bottom: 12px; }
      .color-info { font-size: 0.9em; }
      .color-info strong { font-size: 1.05em; }
      .copy-hex-btn svg { width: 14px; height: 14px; }
      .no-results, .initial-message { font-size: 1.2em; }
      .tool-section { padding: 25px 30px; }
      .tool-section h2 { font-size: 2em; }
      footer { font-size: 0.9em; padding: 20px 25px; padding-bottom: 70px; border-radius: 20px; }
      #dark-mode-toggle { top: 20px; right: 25px; width: 40px; height: 40px; }
      #dark-mode-toggle svg { width: 20px; height: 20px; }
      #scroll-to-top-btn { top: 70px; right: 25px; width: 40px; height: 40px; }
      #scroll-to-top-btn svg { width: 20px; height: 20px; }
      .modal-content { padding: 25px 30px; }
      .modal-color-swatch { height: 120px; }
      .modal-content h2 { font-size: 1.8em; }
      .palette-swatch-item .palette-color-box { width: 60px; height: 60px; }
      #footer-star-link { left: 25px; } /* Adjust positioning for larger screens */
      #footer-3d-star { font-size: 32px; }
      .night-star { width: 2px; height: 2px; }
    }

    @media (min-width: 992px) {
      h1 { font-size: 3.5em; }
      .color-card { width: calc(25% - 15px); }
      .gradient-controls { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
    }
    @media (min-width: 1200px) {
      .color-card { width: calc(20% - 16px); }
    }

  </style>
</head>
<body> 
  <div id="sky-effects-container">
    <div class="aircraft" aria-hidden="true">✈️</div>
    </div>

  <h1>ColorPedia</h1>
  <p style="margin-top:-10px; margin-bottom: 20px;">Discover and explore a world of colors!</p>

  <div id="search-section">
    <div id="search-input-container">
        <input type="text" id="search-box" placeholder="Enter color name or hex (e.g., Sky Blue or #87CEEB)">
        <button id="paste-btn" title="Paste from clipboard">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M0 0h24v24H0V0z" fill="none"/>
                <path d="M19 2h-4.18C14.4.67 13.33 0 12 0S9.6.67 9.18 2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H10v-2h4v2zm3-4H9v-2h7v2zm0-4H9V6h7v2z"/>
            </svg>
        </button>
    </div>
    <button id="search-btn">Search</button>
    </div>

  <div id="color-display">
    <p class="initial-message">Explore colors by searching above, or see a selection of our vibrant palette!</p>
  </div>

  <section id="gradient-generator-section" class="tool-section">
    <h2>CSS Gradient Generator</h2>
    <div class="gradient-controls">
      <div>
        <label for="grad-color-1">Color 1:</label>
        <input type="color" id="grad-color-1" value="#FF6347"> 
      </div>
      <div>
        <label for="grad-color-2">Color 2:</label>
        <input type="color" id="grad-color-2" value="#4682B4"> 
      </div>
      <div>
        <label for="grad-type">Type:</label>
        <select id="grad-type">
          <option value="linear" selected>Linear</option>
          <option value="radial">Radial</option>
        </select>
      </div>
      <div id="linear-grad-options-container"> 
        <label for="grad-direction">Direction (Linear):</label>
        <select id="grad-direction">
          <option value="to right">To Right</option>
          <option value="to left">To Left</option>
          <option value="to bottom">To Bottom</option>
          <option value="to top">To Top</option>
          <option value="to bottom right">To Bottom Right</option>
          <option value="to bottom left">To Bottom Left</option>
          <option value="to top right">To Top Right</option>
          <option value="to top left">To Top Left</option>
          <option value="45deg">45 Degrees</option>
          <option value="135deg">135 Degrees</option>
        </select>
      </div>
    </div>
    <div id="gradient-preview"></div>
    <div class="gradient-output">
      <label for="gradient-css-output">CSS Code:</label>
      <textarea id="gradient-css-output" readonly rows="3"></textarea>
      <button id="copy-gradient-css-btn" title="Copy CSS Gradient Code">Copy CSS</button>
    </div>
  </section>

  <footer>
    <a href="https://sobuj21.github.io/det" target="_blank" id="footer-star-link" aria-label="DET Website">
        <div id="footer-3d-star" title="Visit DET Website">★</div>
    </a>
    <p>Contact me:</p>
    <p>
      <a href="https://www.facebook.com/sobujis" target="_blank" rel="noopener noreferrer">Facebook</a> |
      WhatsApp: <a href="https://wa.me/+17162268360" target="_blank" rel="noopener noreferrer">+17162268360</a> |
      Telegram: <a href="https://t.me/iamSobuj" target="_blank" rel="noopener noreferrer">@iamSobuj</a>
    </p>
    <p>&copy; <script>document.write(new Date().getFullYear())</script> ColorPedia. Powered by Sobuj Islam. All rights reserved.</p>
    
    <button id="dark-mode-toggle" title="Toggle Dark Mode">
      <svg id="theme-icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>
      <svg id="theme-icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="display:none;"><path d="M10 2c-1.82 0-3.53.5-5 1.35C7.99 5.08 10 8.3 10 12s-2.01 6.92-5 8.65C6.47 21.5 8.18 22 10 22c5.52 0 10-4.48 10-10S15.52 2 10 2z"/></svg>
    </button>

    <button id="scroll-to-top-btn" title="Scroll to top">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M0 0h24v24H0V0z" fill="none"/>
            <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6 1.41 1.41z"/>
        </svg>
    </button>
  </footer>

  <div id="color-detail-modal" class="modal-overlay">
    <div class="modal-content">
        <button id="modal-close-btn" class="modal-close-btn" title="Close">&times;</button>
        <div id="modal-color-swatch" class="modal-color-swatch"></div>
        <h2 id="modal-color-name">Color Name</h2>
        <div class="modal-color-details">
            <div class="detail-item">
                <span>HEX:</span>
                <span id="modal-hex-value"></span>
                <button class="copy-detail-btn" data-format="hex" title="Copy HEX Code">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                </button>
            </div>
            <div class="detail-item">
                <span>RGB:</span>
                <span id="modal-rgb-value"></span>
                <button class="copy-detail-btn" data-format="rgb" title="Copy RGB Value">
                     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                </button>
            </div>
            <div class="detail-item">
                <span>HSL:</span>
                <span id="modal-hsl-value"></span>
                <button class="copy-detail-btn" data-format="hsl" title="Copy HSL Value">
                     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                </button>
            </div>
        </div>
        
        <div class="modal-palettes-container">
            <h3>Color Harmonies</h3>
            <div class="palette-section" id="monochromatic-palette-section">
                <h4>Monochromatic</h4>
                <div class="palette-swatches" id="monochromatic-palette"></div>
                <div class="palette-export-options">
                    <button class="export-palette-btn" data-palette-id="monochromatic-palette" data-export-format="hexlist" title="Copy HEX List">HEX List</button>
                    <button class="export-palette-btn" data-palette-id="monochromatic-palette" data-export-format="cssvars" data-var-prefix="mono" title="Copy as CSS Variables">CSS Vars</button>
                </div>
            </div>
            <div class="palette-section" id="analogous-palette-section">
                <h4>Analogous</h4>
                <div class="palette-swatches" id="analogous-palette"></div>
                 <div class="palette-export-options">
                    <button class="export-palette-btn" data-palette-id="analogous-palette" data-export-format="hexlist" title="Copy HEX List">HEX List</button>
                    <button class="export-palette-btn" data-palette-id="analogous-palette" data-export-format="cssvars" data-var-prefix="analog" title="Copy as CSS Variables">CSS Vars</button>
                </div>
            </div>
            <div class="palette-section" id="complementary-palette-section">
                <h4>Complementary</h4>
                <div class="palette-swatches" id="complementary-palette"></div>
                 <div class="palette-export-options">
                    <button class="export-palette-btn" data-palette-id="complementary-palette" data-export-format="hexlist" title="Copy HEX List">HEX List</button>
                    <button class="export-palette-btn" data-palette-id="complementary-palette" data-export-format="cssvars" data-var-prefix="comp" title="Copy as CSS Variables">CSS Vars</button>
                </div>
            </div>
            <div class="palette-section" id="triadic-palette-section">
                <h4>Triadic</h4>
                <div class="palette-swatches" id="triadic-palette"></div>
                 <div class="palette-export-options">
                    <button class="export-palette-btn" data-palette-id="triadic-palette" data-export-format="hexlist" title="Copy HEX List">HEX List</button>
                    <button class="export-palette-btn" data-palette-id="triadic-palette" data-export-format="cssvars" data-var-prefix="triad" title="Copy as CSS Variables">CSS Vars</button>
                </div>
            </div>
        </div>

        <div class="modal-accessibility-container">
            <h3>Accessibility Contrast</h3>
            <div class="contrast-check-item" id="contrast-with-white-text-section">
                <h4>With White Text (#FFFFFF) on This Color Background</h4>
                <p>Ratio: <span class="contrast-ratio-value" id="ratio-white-text">N/A</span></p>
                <ul class="compliance-results" id="results-white-text">
                    <li>AA Normal (4.5:1): <span class="status"></span></li>
                    <li>AA Large (3:1): <span class="status"></span></li>
                    <li>AAA Normal (7:1): <span class="status"></span></li>
                    <li>AAA Large (4.5:1): <span class="status"></span></li>
                </ul>
            </div>
            <div class="contrast-check-item" id="contrast-with-black-text-section">
                <h4>With Black Text (#000000) on This Color Background</h4>
                <p>Ratio: <span class="contrast-ratio-value" id="ratio-black-text">N/A</span></p>
                <ul class="compliance-results" id="results-black-text">
                    <li>AA Normal (4.5:1): <span class="status"></span></li>
                    <li>AA Large (3:1): <span class="status"></span></li>
                    <li>AAA Normal (7:1): <span class="status"></span></li>
                    <li>AAA Large (4.5:1): <span class="status"></span></li>
                </ul>
            </div>
        </div>
    </div>
  </div>
  <script defer>
    // --- UTILITY VARIABLES & ELEMENTS ---
    const copyIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>`;

    // Main page elements
    const searchBoxElement = document.getElementById('search-box');
    const searchBtnElement = document.getElementById('search-btn');
    const colorDisplayElement = document.getElementById('color-display');
    const darkModeToggleElement = document.getElementById('dark-mode-toggle');
    const sunIconElement = document.getElementById('theme-icon-sun');
    const moonIconElement = document.getElementById('theme-icon-moon'); // Still referenced by ID, but its display is controlled
    const siteTitleElement = document.querySelector('h1');
    const scrollToTopBtnElement = document.getElementById('scroll-to-top-btn');
    const pasteBtnElement = document.getElementById('paste-btn'); 

    // Modal elements
    const modalOverlayElement = document.getElementById('color-detail-modal');
    const modalCloseBtnElement = document.getElementById('modal-close-btn');
    const modalColorSwatchElement = document.getElementById('modal-color-swatch');
    const modalColorNameElement = document.getElementById('modal-color-name');
    const modalHexValueElement = document.getElementById('modal-hex-value');
    const modalRgbValueElement = document.getElementById('modal-rgb-value');
    const modalHslValueElement = document.getElementById('modal-hsl-value');
    const modalCopyButtonsContainer = modalOverlayElement.querySelector('.modal-color-details');
    const modalPalettesContainer = modalOverlayElement.querySelector('.modal-palettes-container');
    const ratioWhiteTextElement = document.getElementById('ratio-white-text');
    const resultsWhiteTextElement = document.getElementById('results-white-text');
    const ratioBlackTextElement = document.getElementById('ratio-black-text');
    const resultsBlackTextElement = document.getElementById('results-black-text');

    // Gradient Generator Elements
    const gradColor1Input = document.getElementById('grad-color-1');
    const gradColor2Input = document.getElementById('grad-color-2');
    const gradTypeSelect = document.getElementById('grad-type');
    const gradDirectionSelect = document.getElementById('grad-direction');
    const linearGradOptionsContainer = document.getElementById('linear-grad-options-container');
    const gradientPreviewDiv = document.getElementById('gradient-preview');
    const gradientCssOutputTextarea = document.getElementById('gradient-css-output');
    const copyGradientCssBtn = document.getElementById('copy-gradient-css-btn');

    // --- CONSTANTS & MESSAGES ---
    const WELCOME_MESSAGE = "Welcome to ColorPedia! Here's a taste of our vibrant palette. Use the search bar above to find specific colors, or try the Gradient Generator below!";
    const SEARCH_PROMPT_MESSAGE = "Enter a color name or hex code to start your search, or discover some of our featured colors below!";
    const NO_COLORS_IN_DB_MESSAGE = "No colors available in the database currently. Please check back later!";
    const WCAG_LEVELS = {
        AA_NORMAL: 4.5, AA_LARGE: 3, AAA_NORMAL: 7, AAA_LARGE: 4.5
    };

    // --- COLOR DATABASE ---
    const colorDatabase = [ 
      { name: "Indian Red", hex: "#CD5C5C" }, { name: "Light Coral", hex: "#F08080" }, { name: "Salmon", hex: "#FA8072" }, 
      { name: "Dark Salmon", hex: "#E9967A" }, { name: "Light Salmon", hex: "#FFA07A" }, { name: "Crimson", hex: "#DC143C" },
      { name: "Red", hex: "#FF0000" }, { name: "Matte Red", hex: "#B33F40" }, { name: "Glossy Red", hex: "#DD0004" },
      { name: "Light Red", hex: "#c91100" }, { name: "Metallic Red", hex: "#B71C1C" }, { name: "Fire Brick", hex: "#B22222" },
      { name: "Dark Red", hex: "#8B0000" },{ name: "Alabama Crimson", hex: "#AF002A" }, { name: "Pink", hex: "#FFC0CB" },
      { name: "Matte Pink", hex: "#EC407A" }, { name: "Metallic Pink", hex: "#AD1457" }, { name: "Light Pink", hex: "#FFB6C1" },
      { name: "Hot Pink", hex: "#FF69B4" }, { name: "Deep Pink", hex: "#FF1493" }, { name: "Medium Violet Red", hex: "#C71585" },
      { name: "Pale Violet Red", hex: "#DB7093" }, { name: "Soft Pink", hex: "#E89EB8" }, { name: "Coral", hex: "#FF7F50" },
      { name: "Tomato", hex: "#FF6347" }, { name: "Orange Red", hex: "#FF4500" }, { name: "Dark Orange", hex: "#FF8C00" },
      { name: "Orange", hex: "#FFA500" }, { name: "Matte Orange", hex: "#F57C00" }, { name: "Metallic Orange", hex: "#E65100" },
      { name: "Gold", hex: "#FFD700" }, { name: "Yellow", hex: "#FFFF00" }, { name: "Matte Yellow", hex: "#FBC02D" },
      { name: "Metallic Yellow", hex: "#F9A825" }, { name: "Light Yellow", hex: "#FFFFE0" }, { name: "Lemon Chiffon", hex: "#FFFACD" },
      { name: "Papaya Whip", hex: "#FFEFD5" }, { name: "Moccasin", hex: "#FFE4B5" }, { name: "Peach Puff", hex: "#FFDAB9" },
      { name: "Pale Goldenrod", hex: "#EEE8AA" }, { name: "Khaki", hex: "#F0E68C" }, { name: "Dark Khaki", hex: "#BDB76B" },
      { name: "BRIMSTONE YELLOW", hex: "#F4D83F" }, { name: "Green Yellow", hex: "#ADFF2F" }, { name: "Chartreuse", hex: "#7FFF00" },
      { name: "Lawn Green", hex: "#7CFC00" }, { name: "Lime", hex: "#00FF00" }, { name: "Matte Lime", hex: "#AFB42B" },
      { name: "Metallic Lime", hex: "#827717" }, { name: "Lime Green", hex: "#32CD32" }, { name: "Pale Green", hex: "#98FB98" },
      { name: "Light Green", hex: "#90EE90" }, { name: "Medium Spring Green", hex: "#00FA9A" }, { name: "Spring Green", hex: "#00FF7F" },
      { name: "Medium Sea Green", hex: "#3CB371" }, { name: "Sea Green", hex: "#2E8B57" }, { name: "Forest Green", hex: "#228B22" },
      { name: "Green", hex: "#008000" }, { name: "Matte Green", hex: "#48A14D" }, { name: "Metallic Green", hex: "#1B5E20" },
      { name: "Dark Green", hex: "#006400" }, { name: "Yellow Green", hex: "#9ACD32" }, { name: "Olive Drab", hex: "#6B8E23" }, 
      { name: "Olive", hex: "#808000" }, { name: "Dark Olive Green", hex: "#556B2F" }, { name: "Dark Sea Green", hex: "#8FBC8F" },
      { name: "Light Sea Green", hex: "#20B2AA" }, { name: "Dark Cyan", hex: "#008B8B" }, { name: "Teal", hex: "#008080" },
      { name: "Acid Green", hex: "#B0BF1A" }, { name: "Aqua", hex: "#00FFFF" }, { name: "Cyan", hex: "#00FFFF" },
      { name: "Matte Cyan", hex: "#00ACC1" }, { name: "Metallic Cyan", hex: "#00838F" }, { name: "Light Cyan", hex: "#E0FFFF" },
      { name: "Pale Turquoise", hex: "#AFEEEE" }, { name: "Aquamarine", hex: "#7FFFD4" }, { name: "Turquoise", hex: "#40E0D0" },
      { name: "Medium Turquoise", hex: "#48D1CC" }, { name: "Dark Turquoise", hex: "#00CED1" }, { name: "Zomp", hex: "#39A78E" },
      { name: "Cadet Blue", hex: "#5F9EA0" }, { name: "Steel Blue", hex: "#4682B4" }, { name: "Light Steel Blue", hex: "#B0C4DE" },
      { name: "Powder Blue", hex: "#B0E0E6" }, { name: "Light Blue", hex: "#ADD8E6" }, { name: "Sky Blue", hex: "#87CEEB" },
      { name: "Light Sky Blue", hex: "#87CEFA" }, { name: "Deep Sky Blue", hex: "#00BFFF" }, { name: "Dodger Blue", hex: "#1E90FF" },
      { name: "Cornflower Blue", hex: "#6495ED" }, { name: "Medium Slate Blue", hex: "#7B68EE" }, { name: "Royal Blue", hex: "#4169E1" },
      { name: "Blue", hex: "#0000FF" }, { name: "Matte Blue", hex: "#1976D2" }, { name: "Metallic Blue", hex: "#0D47A1" },
      { name: "Medium Blue", hex: "#0000CD" }, { name: "Dark Blue", hex: "#00008B" }, { name: "Navy", hex: "#000080" },
      { name: "Matte Navy", hex: "#283593" }, { name: "Metallic Navy", hex: "#1A237E" }, { name: "Midnight Blue", hex: "#191970" },
      { name: "Matte Dark Blue", hex: "#0B0B60" }, { name: "Brilliant Blue", hex: "#2752D6" },{ name: "Air Superiority Blue", hex: "#72A0C1" },
      { name: "Aero Blue", hex: "#C9FFE5" },{ name: "Air Force Blue (RAF)", hex: "#5D8AA8" }, { name: "Absolute Zero", hex: "#0048BA" },
      { name: "Aero", hex: "#7CB9E8" }, { name: "Zaffre", hex: "#0014A8" }, { name: "Lavender", hex: "#E6E6FA" },
      { name: "Thistle", hex: "#D8BFD8" }, { name: "Plum", hex: "#DDA0DD" }, { name: "Violet", hex: "#EE82EE" },
      { name: "Matte Violet", hex: "#8658A5" }, { name: "Orchid", hex: "#DA70D6" }, { name: "Fuchsia", hex: "#FF00FF" },
      { name: "Magenta", hex: "#FF00FF" }, { name: "Matte Magenta", hex: "#C2185B" }, { name: "Metallic Magenta", hex: "#880E4F" }, 
      { name: "Medium Orchid", hex: "#BA55D3" }, { name: "Medium Purple", hex: "#9370DB" }, { name: "Rebecca Purple", hex: "#663399" },
      { name: "Blue Violet", hex: "#8A2BE2" }, { name: "Dark Violet", hex: "#9400D3" }, { name: "Dark Orchid", hex: "#9932CC" }, 
      { name: "Dark Magenta", hex: "#8B008B" }, { name: "Purple", hex: "#800080" }, { name: "Matte Purple", hex: "#7B1FA2" },
      { name: "Metallic Purple", hex: "#4A148C" }, { name: "Indigo", hex: "#4B0082" }, { name: "Slate Blue", hex: "#6A5ACD" }, 
      { name: "Dark Slate Blue", hex: "#483D8B" }, { name: "Matte Burgundy", hex: "#691C2D" }, { name: "African Violet", hex: "#B284BE" },
      { name: "Cornsilk", hex: "#FFF8DC" }, { name: "Blanched Almond", hex: "#FFEBCD" }, { name: "Bisque", hex: "#FFE4C4" },
      { name: "Navajo White", hex: "#FFDEAD" }, { name: "Wheat", hex: "#F5DEB3" }, { name: "Burly Wood", hex: "#DEB887" },
      { name: "Tan", hex: "#D2B48C" }, { name: "Rosy Brown", hex: "#BC8F8F" }, { name: "Sandy Brown", hex: "#F4A460" },
      { name: "Goldenrod", hex: "#DAA520" }, { name: "Dark Goldenrod", hex: "#B8860B" }, { name: "Peru", hex: "#CD853F" },
      { name: "Chocolate", hex: "#D2691E" }, { name: "Saddle Brown", hex: "#8B4513" }, { name: "Sienna", hex: "#A0522D" },
      { name: "Brown", hex: "#A52A2A" }, { name: "Matte Brown", hex: "#5D4037" }, { name: "Metallic Brown", hex: "#3E2723" },
      { name: "Maroon", hex: "#800000" },{ name: "Zinnwaldite Brown", hex: "#2C1608" }, { name: "White", hex: "#FFFFFF" },
      { name: "Matte White", hex: "#e6e9e9" }, { name: "Metallic White", hex: "#ECEFF1" }, { name: "Snow", hex: "#FFFAFA" },
      { name: "Honey Dew", hex: "#F0FFF0" }, { name: "Mint Cream", hex: "#F5FFFA" }, { name: "Azure", hex: "#F0FFFF" },
      { name: "Alice Blue", hex: "#F0F8FF" }, { name: "Ghost White", hex: "#F8F8FF" }, { name: "White Smoke", hex: "#F5F5F5" },
      { name: "Sea Shell", hex: "#FFF5EE" }, { name: "Beige", hex: "#F5F5DC" }, { name: "Old Lace", hex: "#FDF5E6" },
      { name: "Floral White", hex: "#FFFAF0" }, { name: "Ivory", hex: "#FFFFF0" }, { name: "Antique White", hex: "#FAEBD7" },
      { name: "Linen", hex: "#FAF0E6" }, { name: "Lavender Blush", hex: "#FFF0F5" }, { name: "Gainsboro", hex: "#DCDCDC" },
      { name: "Light Gray", hex: "#D3D3D3" }, { name: "Silver", hex: "#C0C0C0" }, { name: "Dark Gray", hex: "#A9A9A9" },
      { name: "Gray", hex: "#808080" }, { name: "Matte Gray", hex: "#757575" }, { name: "Metallic Gray", hex: "#616161" },
      { name: "Silver Gray Metallic", hex: "#8A92A6" }, { name: "Dim Gray", hex: "#696969" }, { name: "Lavender Gray", hex: "#C3C5C9" },
      { name: "Light Slate Gray", hex: "#778899" }, { name: "Slate Gray", hex: "#708090" }, { name: "Dark Slate Gray", hex: "#2F4F4F" },
      { name: "Black", hex: "#000000" }, { name: "Matte Black", hex: "#28282B" }, { name: "Velvet Black", hex: "#231f20" },
      { name: "Metallic Black", hex: "#424242" }
    ];

    // --- SKY EFFECTS ELEMENTS ---
    const skyEffectsContainer = document.getElementById('sky-effects-container');
    const aircraftElement = document.querySelector('.aircraft');
    // const moonElement = document.querySelector('.moon'); // Moon element removed
    let nightStars = []; 
    const NUM_NIGHT_STARS = 80; 


    // --- COLOR CONVERSION UTILITIES ---
    function hexToRgb(hex) {
        let normalizedHex = hex.replace(/^#/, '');
        if (normalizedHex.length === 3) {
            normalizedHex = normalizedHex[0].repeat(2) + normalizedHex[1].repeat(2) + normalizedHex[2].repeat(2);
        }
        const num = parseInt(normalizedHex, 16);
        const r = (num >> 16) & 255;
        const g = (num >> 8) & 255;
        const b = num & 255;
        return { r, g, b };
    }

    function hexToHsl(hex) {
        const { r: r255, g: g255, b: b255 } = hexToRgb(hex);
        const r = r255 / 255, g = g255 / 255, b = b255 / 255;
        const max = Math.max(r, g, b), min = Math.min(r, g, b);
        let h, s, l = (max + min) / 2;
        if (max === min) {
            h = s = 0; 
        } else {
            const d = max - min;
            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
            switch (max) {
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }
            h /= 6;
        }
        return { h: Math.round(h * 360), s: Math.round(s * 100), l: Math.round(l * 100) };
    }

    function hslToRgb(h, s, l) {
        s /= 100; l /= 100;
        const k = n => (n + h / 30) % 12;
        const a = s * Math.min(l, 1 - l);
        const f = n => l - a * Math.max(-1, Math.min(k(n) - 3, Math.min(9 - k(n), 1)));
        return { r: Math.round(255 * f(0)), g: Math.round(255 * f(8)), b: Math.round(255 * f(4)) };
    }

    function rgbToHex(r, g, b) {
        return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase();
    }

    function hslToHex(h, s, l) {
        const {r,g,b} = hslToRgb(h,s,l);
        return rgbToHex(r,g,b);
    }

    // --- THEME MANAGEMENT (Modified for Sky Effects) ---
    function applyTheme(theme) {
      const isDarkMode = theme === 'dark';
      document.body.classList.toggle('dark-mode', isDarkMode);
      
      if(sunIconElement) sunIconElement.style.display = isDarkMode ? 'none' : 'block';
      if(moonIconElement) moonIconElement.style.display = isDarkMode ? 'block' : 'none'; // This line is for the toggle icon, not the visual moon
      if(darkModeToggleElement) darkModeToggleElement.title = isDarkMode ? 'Switch to Light Mode' : 'Switch to Dark Mode';

      // Toggle night sky elements
      if (isDarkMode) {
        // Moon logic removed
        createNightStarsIfNeeded();
        nightStars.forEach(star => {
            star.classList.add('visible'); 
        });
      } else {
        // Moon logic removed
        nightStars.forEach(star => {
          star.classList.remove('visible');
        });
      }
    }


    // --- COLOR CARD RENDERING & DISPLAY ---
    function renderColorCard(name, hex) {
      const properHex = hex.toUpperCase();
      return `
        <div class="color-card" data-name="${name}" data-hex="${properHex}">
          <div class="color-box" style="background: ${properHex}" title="View Details for ${name}"></div>
          <div class="color-info">
            <strong title="View Details for ${name}">${name}</strong>
            <div class="hex-container">
              <span>${properHex}</span>
              <button class="copy-hex-btn" data-hex="${properHex}" title="Copy hex code">
                ${copyIconSVG} 
              </button>
            </div>
          </div>
        </div>
      `;
    }

    function appendInitialSampleCards() {
        const sampleSize = 12;
        const sampleColors = [];
        const usedIndices = new Set();
        if (colorDatabase.length === 0) return;
        const effectiveSampleSize = Math.min(sampleSize, colorDatabase.length);

        if (colorDatabase.length <= effectiveSampleSize) {
            sampleColors.push(...colorDatabase);
        } else {
            while(sampleColors.length < effectiveSampleSize) {
                const randomIndex = Math.floor(Math.random() * colorDatabase.length);
                if (!usedIndices.has(randomIndex)) {
                    sampleColors.push(colorDatabase[randomIndex]);
                    usedIndices.add(randomIndex);
                }
            }
        }
        let cardsHtmlContent = '';
        sampleColors.forEach(color => {
            cardsHtmlContent += renderColorCard(color.name, color.hex);
        });
        if(colorDisplayElement) colorDisplayElement.insertAdjacentHTML('beforeend', cardsHtmlContent);
    }

    function displayColors(colorsToDisplay) {
      let htmlContent = '';
      if (colorsToDisplay.length > 0) {
        colorsToDisplay.forEach(color => {
          htmlContent += renderColorCard(color.name, color.hex);
        });
      } else {
        htmlContent = '<p class="no-results">No matching color found. Try a different name or hex code.</p>';
      }
      if(colorDisplayElement) colorDisplayElement.innerHTML = htmlContent;
    }
    
    // --- SEARCH FUNCTIONALITY ---
    function performSearch() {
      if(!searchBoxElement || !colorDisplayElement) return;
      const query = searchBoxElement.value.trim().toLowerCase();
      if (query === "") {
        colorDisplayElement.innerHTML = `<p class="initial-message">${SEARCH_PROMPT_MESSAGE}</p>`;
        appendInitialSampleCards();
        return;
      }
      const hexQuery = query.startsWith('#') ? query.substring(1) : query;
      const filteredColors = colorDatabase.filter(color => {
        const colorNameLower = color.name.toLowerCase();
        const colorHexLower = color.hex.toLowerCase();
        const cleanColorHex = colorHexLower.startsWith('#') ? colorHexLower.substring(1) : colorHexLower;
        return colorNameLower.includes(query) || cleanColorHex.includes(hexQuery) || colorHexLower.includes(query);
      });
      displayColors(filteredColors);
    }

    // --- MODAL FUNCTIONALITY (Details, Palettes, Accessibility) ---
    function generateMonochromaticPalette(baseHsl, count = 5) {
        const palette = [];
        const step = Math.round(80 / (count > 1 ? count -1 : 1)); 
        for (let i = 0; i < count; i++) {
            let l = baseHsl.l - Math.floor(count / 2) * step + (i * step);
            if (count === 1) l = baseHsl.l; 
            l = Math.max(5, Math.min(95, l)); 
            palette.push(hslToHex(baseHsl.h, baseHsl.s, l));
        }
        return palette;
    }

    function generateAnalogousPalette(baseHsl, count = 3, angle = 30) {
        const palette = [hslToHex(baseHsl.h, baseHsl.s, baseHsl.l)];
        if (count > 1) palette.push(hslToHex((baseHsl.h - angle + 360) % 360, baseHsl.s, baseHsl.l));
        if (count > 2) palette.push(hslToHex((baseHsl.h + angle + 360) % 360, baseHsl.s, baseHsl.l));
        return palette.sort((a,b) => hexToHsl(a).h - hexToHsl(b).h).slice(0,count); 
    }
    
    function generateComplementaryPalette(baseHsl) {
        return [
            hslToHex(baseHsl.h, baseHsl.s, baseHsl.l),
            hslToHex((baseHsl.h + 180 + 360) % 360, baseHsl.s, baseHsl.l)
        ];
    }

    function generateTriadicPalette(baseHsl, count = 3) {
        const palette = [hslToHex(baseHsl.h, baseHsl.s, baseHsl.l)];
        if (count > 1) palette.push(hslToHex((baseHsl.h + 120 + 360) % 360, baseHsl.s, baseHsl.l));
        if (count > 2) palette.push(hslToHex((baseHsl.h + 240 + 360) % 360, baseHsl.s, baseHsl.l));
        return palette.sort((a,b) => hexToHsl(a).h - hexToHsl(b).h).slice(0,count);
    }
    
    function renderPaletteSwatches(paletteType, colorsArray) {
        const swatchesContainer = document.getElementById(`${paletteType}-palette`);
        if (!swatchesContainer) return;
        swatchesContainer.innerHTML = ''; 
        colorsArray.forEach(hex => {
            const swatchItem = document.createElement('div');
            swatchItem.className = 'palette-swatch-item';
            const colorBox = document.createElement('div');
            colorBox.className = 'palette-color-box';
            colorBox.style.backgroundColor = hex;
            const hexCodeSpan = document.createElement('span');
            hexCodeSpan.className = 'palette-hex-code';
            hexCodeSpan.textContent = hex;
            const copyBtn = document.createElement('button');
            copyBtn.className = 'copy-palette-color-btn';
            copyBtn.dataset.hex = hex;
            copyBtn.title = `Copy ${hex}`;
            copyBtn.innerHTML = copyIconSVG;
            swatchItem.appendChild(colorBox);
            swatchItem.appendChild(hexCodeSpan);
            swatchItem.appendChild(copyBtn);
            swatchesContainer.appendChild(swatchItem);
        });
    }

    function getRelativeLuminance(hexColor) {
        const rgb = hexToRgb(hexColor);
        const [r, g, b] = [rgb.r, rgb.g, rgb.b].map(val => {
            const sRGB = val / 255;
            return (sRGB <= 0.03928) ? sRGB / 12.92 : Math.pow((sRGB + 0.055) / 1.055, 2.4);
        });
        return 0.2126 * r + 0.7152 * g + 0.0722 * b;
    }

    function getContrastRatio(hex1, hex2) {
        const lum1 = getRelativeLuminance(hex1);
        const lum2 = getRelativeLuminance(hex2);
        const lighter = Math.max(lum1, lum2);
        const darker = Math.min(lum1, lum2);
        return (lighter + 0.05) / (darker + 0.05);
    }

    function checkWcagCompliance(ratio) {
        return {
            AANormal: ratio >= WCAG_LEVELS.AA_NORMAL, AALarge: ratio >= WCAG_LEVELS.AA_LARGE,
            AAANormal: ratio >= WCAG_LEVELS.AAA_NORMAL, AAALarge: ratio >= WCAG_LEVELS.AAA_LARGE
        };
    }

    function displayContrastResults(bgColorHex, textColorHex, ratioDisplayElement, resultsListElement) {
        if(!ratioDisplayElement || !resultsListElement) return;
        const ratio = getContrastRatio(textColorHex, bgColorHex);
        const compliance = checkWcagCompliance(ratio);

        ratioDisplayElement.textContent = ratio.toFixed(2) + " : 1";
        const statuses = resultsListElement.querySelectorAll('.status');
        
        statuses[0].textContent = compliance.AANormal ? 'Pass' : 'Fail';
        statuses[0].className = compliance.AANormal ? 'status pass' : 'status fail';
        statuses[1].textContent = compliance.AALarge ? 'Pass' : 'Fail';
        statuses[1].className = compliance.AALarge ? 'status pass' : 'status fail';
        statuses[2].textContent = compliance.AAANormal ? 'Pass' : 'Fail';
        statuses[2].className = compliance.AAANormal ? 'status pass' : 'status fail';
        statuses[3].textContent = compliance.AAALarge ? 'Pass' : 'Fail';
        statuses[3].className = compliance.AAALarge ? 'status pass' : 'status fail';
    }

    function openModal(name, hex) {
        if(!modalOverlayElement || !modalColorSwatchElement || !modalColorNameElement || !modalHexValueElement || !modalRgbValueElement || !modalHslValueElement) return;
        
        const rgb = hexToRgb(hex);
        const hsl = hexToHsl(hex);

        modalColorSwatchElement.style.background = hex;
        modalColorNameElement.textContent = name;
        modalHexValueElement.textContent = hex.toUpperCase();
        modalRgbValueElement.textContent = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
        modalHslValueElement.textContent = `hsl(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`;
        
        renderPaletteSwatches('monochromatic', generateMonochromaticPalette(hsl, 5));
        renderPaletteSwatches('analogous', generateAnalogousPalette(hsl, 3));
        renderPaletteSwatches('complementary', generateComplementaryPalette(hsl));
        renderPaletteSwatches('triadic', generateTriadicPalette(hsl, 3));

        displayContrastResults(hex, '#FFFFFF', ratioWhiteTextElement, resultsWhiteTextElement);
        displayContrastResults(hex, '#000000', ratioBlackTextElement, resultsBlackTextElement);

        modalOverlayElement.classList.add('visible');
        document.body.style.overflow = 'hidden'; 
    }

    function closeModal() {
        if(!modalOverlayElement) return;
        modalOverlayElement.classList.remove('visible');
        document.body.style.overflow = ''; 
    }

    // --- GRADIENT GENERATOR FUNCTIONALITY ---
    function updateGradientPreviewAndCode() {
        if (!gradColor1Input || !gradColor2Input || !gradTypeSelect || !gradDirectionSelect || !gradientPreviewDiv || !gradientCssOutputTextarea || !linearGradOptionsContainer) return;

        const color1 = gradColor1Input.value;
        const color2 = gradColor2Input.value;
        const type = gradTypeSelect.value;
        const direction = gradDirectionSelect.value;

        let cssGradient = '';

        if (type === 'linear') {
            linearGradOptionsContainer.style.display = 'flex'; 
            cssGradient = `linear-gradient(${direction}, ${color1}, ${color2})`;
        } else if (type === 'radial') {
            linearGradOptionsContainer.style.display = 'none'; 
            cssGradient = `radial-gradient(circle, ${color1}, ${color2})`;
        }

        gradientPreviewDiv.style.background = cssGradient;
        gradientCssOutputTextarea.value = `background: ${cssGradient};`;
    }
    
    // --- CLIPBOARD COPY FUNCTIONALITY ---
    function handleCopyAttempt(textToCopy, buttonElement, originalButtonContent) {
        const isIconButton = originalButtonContent.toLowerCase().includes('<svg');
        
        const showSuccess = () => {
            buttonElement.textContent = 'Copied!';
            buttonElement.classList.add('copied');
            buttonElement.classList.remove('error');
            buttonElement.disabled = true;
            setTimeout(() => {
                if (isIconButton) buttonElement.innerHTML = originalButtonContent;
                else buttonElement.textContent = originalButtonContent;
                buttonElement.classList.remove('copied');
                buttonElement.disabled = false;
            }, 1500);
        };

        const showError = () => {
            buttonElement.textContent = 'Error!';
            buttonElement.classList.add('error');
            buttonElement.classList.remove('copied');
            buttonElement.disabled = true;
            setTimeout(() => {
                if (isIconButton) buttonElement.innerHTML = originalButtonContent;
                else buttonElement.textContent = originalButtonContent;
                buttonElement.classList.remove('error');
                buttonElement.disabled = false;
            }, 1500);
        };

        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(textToCopy).then(showSuccess).catch(err => {
                console.warn('navigator.clipboard.writeText failed, trying fallback: ', err);
                fallbackCopyTextToClipboard(textToCopy, showSuccess, showError);
            });
        } else {
            console.warn('navigator.clipboard.writeText not available, using fallback.');
            fallbackCopyTextToClipboard(textToCopy, showSuccess, showError);
        }
    }

    function fallbackCopyTextToClipboard(text, successCallback, errorCallback) {
      const textArea = document.createElement("textarea");
      textArea.value = text;
      textArea.style.top = "0"; textArea.style.left = "0"; textArea.style.position = "fixed";
      textArea.setAttribute('readonly', ''); textArea.style.opacity = "0";
      document.body.appendChild(textArea);
      textArea.focus(); textArea.select();
      try {
        const successful = document.execCommand('copy');
        if (successful) successCallback(); else errorCallback();
      } catch (err) { errorCallback(); }
      document.body.removeChild(textArea);
    }


    // --- NEW SKY EFFECTS JAVASCRIPT ---
    function createShootingStar() {
        if (!skyEffectsContainer) return;
        const star = document.createElement('div');
        star.className = 'shooting-star';

        const angleDeg = Math.random() * 40 - 20; 
        const startX = Math.random() > 0.5 ? '-10vw' : '110vw'; 
        const startY = (Math.random() * 50 + 5) + 'vh'; 
        
        let endX, endY;
        if (startX === '-10vw') { 
            endX = '120vw';
            endY = (parseFloat(startY) + Math.tan(angleDeg * Math.PI / 180) * 130) + 'vh'; 
        } else { 
            endX = '-20vw';
            endY = (parseFloat(startY) - Math.tan(angleDeg * Math.PI / 180) * 130) + 'vh';
        }

        star.style.setProperty('--start-x', startX);
        star.style.setProperty('--start-y', startY);
        star.style.setProperty('--end-x', endX);
        star.style.setProperty('--end-y', endY);
        star.style.setProperty('--angle', angleDeg + 'deg');
        
        const duration = Math.random() * 3 + 2; 
        star.style.animationDuration = duration + 's';
        
        skyEffectsContainer.appendChild(star);

        star.addEventListener('animationend', () => {
            star.remove();
        });
    }

    function createSmokeParticle(aircraftRect) {
        if (!skyEffectsContainer || !aircraftElement) return;
        const particle = document.createElement('div');
        particle.className = 'smoke-particle';
        
        const aircraftStyle = getComputedStyle(aircraftElement);
        const aircraftTransform = new DOMMatrix(aircraftStyle.transform);
        const aircraftX = aircraftTransform.m41; 
        const aircraftY = aircraftTransform.m42; 

        const offsetX = -10; 
        const offsetY = aircraftElement.offsetHeight / 2;


        particle.style.left = (aircraftX + offsetX + Math.random()*10-5) + 'px';
        particle.style.top = (aircraftY + offsetY + Math.random()*10-5) + 'px';
        
        const hue = Math.random() * 360;
        particle.style.backgroundColor = `hsl(${hue}, 100%, 70%)`;
        
        skyEffectsContainer.appendChild(particle);
        particle.addEventListener('animationend', () => {
            particle.remove();
        });
    }
    
    let smokeInterval;
    function startSmokeTrail() {
        if (!aircraftElement) return;
        if (smokeInterval) clearInterval(smokeInterval); 
        smokeInterval = setInterval(() => {
            const rect = aircraftElement.getBoundingClientRect();
            createSmokeParticle(rect);
        }, 100); 
    }
    
    function createNightStarsIfNeeded() {
        if (!skyEffectsContainer || nightStars.length > 0) return; 

        for (let i = 0; i < NUM_NIGHT_STARS; i++) {
            const star = document.createElement('div');
            star.className = 'night-star';
            star.style.left = Math.random() * 100 + 'vw';
            star.style.top = Math.random() * 100 + 'vh';
            star.style.animationDelay = Math.random() * 3 + 's'; 
            const size = Math.random() * 1.5 + 0.5; 
            star.style.width = size + 'px';
            star.style.height = size + 'px';

            skyEffectsContainer.appendChild(star);
            nightStars.push(star);
        }
    }

    function clearNightStars() {
        nightStars.forEach(star => star.remove());
        nightStars = [];
    }

    // --- END OF NEW SKY EFFECTS JAVASCRIPT ---


    // --- EVENT LISTENERS ---
    if(darkModeToggleElement) {
        darkModeToggleElement.addEventListener('click', () => {
          const newTheme = document.body.classList.contains('dark-mode') ? 'light' : 'dark'; 
          localStorage.setItem('theme', newTheme);
          applyTheme(newTheme); 
        });
    }

    if(searchBtnElement) searchBtnElement.addEventListener('click', performSearch);
    if(searchBoxElement) searchBoxElement.addEventListener('keypress', (event) => {
      if (event.key === 'Enter') performSearch();
    });
    if(pasteBtnElement && searchBoxElement) {
        pasteBtnElement.addEventListener('click', async () => {
            try {
                if (navigator.clipboard && navigator.clipboard.readText) {
                    const text = await navigator.clipboard.readText();
                    searchBoxElement.value = text;
                    searchBoxElement.focus(); 
                } else { 
                    searchBoxElement.focus();
                    const pasted = document.execCommand('paste'); 
                    if (!pasted) console.warn('Paste command failed. Please use Ctrl+V or Cmd+V.');
                }
            } catch (err) {
                console.error('Failed to read clipboard contents: ', err);
            }
        });
    }

    if(siteTitleElement) siteTitleElement.addEventListener('click', () => window.location.reload());

    if(colorDisplayElement) {
        colorDisplayElement.addEventListener('click', function(event) {
            const cardHexCopyButton = event.target.closest('.copy-hex-btn');
            const cardElement = event.target.closest('.color-card');
            
            if (cardHexCopyButton) { 
                const hexToCopy = cardHexCopyButton.dataset.hex;
                handleCopyAttempt(hexToCopy, cardHexCopyButton, copyIconSVG);
                event.stopPropagation(); 
                return;
            }

            if (cardElement && (event.target.matches('.color-box') || event.target.matches('.color-info strong'))) {
                const name = cardElement.dataset.name;
                const hex = cardElement.dataset.hex;
                if (name && hex) openModal(name, hex);
            }
        });
    }
    
    if(modalCloseBtnElement) modalCloseBtnElement.addEventListener('click', closeModal);
    if(modalOverlayElement) modalOverlayElement.addEventListener('click', (event) => {
        if (event.target === modalOverlayElement) closeModal();
    });
    document.addEventListener('keydown', (event) => { 
        if (event.key === 'Escape' && modalOverlayElement && modalOverlayElement.classList.contains('visible')) closeModal();
    });

    if (modalCopyButtonsContainer) { 
        modalCopyButtonsContainer.addEventListener('click', function(event) {
            const modalCopyButton = event.target.closest('.copy-detail-btn');
            if (modalCopyButton) {
                const format = modalCopyButton.dataset.format;
                let valueToCopy = '';
                if (format === 'hex' && modalHexValueElement) valueToCopy = modalHexValueElement.textContent;
                else if (format === 'rgb' && modalRgbValueElement) valueToCopy = modalRgbValueElement.textContent;
                else if (format === 'hsl' && modalHslValueElement) valueToCopy = modalHslValueElement.textContent;
                
                if (valueToCopy) {
                    handleCopyAttempt(valueToCopy, modalCopyButton, modalCopyButton.innerHTML);
                }
            }
        });
    }

    if (modalPalettesContainer) {
        modalPalettesContainer.addEventListener('click', function(event) {
            const paletteCopyButton = event.target.closest('.copy-palette-color-btn');
            if (paletteCopyButton) {
                const hexToCopy = paletteCopyButton.dataset.hex;
                if (hexToCopy) {
                    handleCopyAttempt(hexToCopy, paletteCopyButton, paletteCopyButton.innerHTML);
                }
            }

            const exportButton = event.target.closest('.export-palette-btn');
            if (exportButton) {
                const paletteId = exportButton.dataset.paletteId;
                const exportFormat = exportButton.dataset.exportFormat;
                const varPrefix = exportButton.dataset.varPrefix || 'color';
                const paletteSwatchesDiv = document.getElementById(paletteId);
                
                if (paletteSwatchesDiv) {
                    const hexCodes = Array.from(paletteSwatchesDiv.querySelectorAll('.copy-palette-color-btn'))
                                          .map(btn => btn.dataset.hex.toUpperCase());
                    let stringToCopy = '';
                    if (exportFormat === 'hexlist') stringToCopy = hexCodes.join(', ');
                    else if (exportFormat === 'cssvars') stringToCopy = hexCodes.map((hex, index) => `--${varPrefix}-${index + 1}: ${hex};`).join('\n');
                    if (stringToCopy) handleCopyAttempt(stringToCopy, exportButton, exportButton.textContent);
                }
            }
        });
    }

    if (gradColor1Input) gradColor1Input.addEventListener('input', updateGradientPreviewAndCode);
    if (gradColor2Input) gradColor2Input.addEventListener('input', updateGradientPreviewAndCode);
    if (gradTypeSelect) gradTypeSelect.addEventListener('change', updateGradientPreviewAndCode);
    if (gradDirectionSelect) gradDirectionSelect.addEventListener('change', updateGradientPreviewAndCode);
    if (copyGradientCssBtn && gradientCssOutputTextarea) {
        copyGradientCssBtn.addEventListener('click', () => {
            handleCopyAttempt(gradientCssOutputTextarea.value, copyGradientCssBtn, copyGradientCssBtn.textContent);
        });
    }
    
    if (scrollToTopBtnElement) {
        window.onscroll = function() {
          if(!scrollToTopBtnElement) return; 
          if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
            scrollToTopBtnElement.classList.add('visible');
          } else {
            scrollToTopBtnElement.classList.remove('visible');
          }
        };
        scrollToTopBtnElement.addEventListener('click', () => {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    }

    // --- RIGHT-CLICK PROTECTION ---
    document.addEventListener('contextmenu', function(event) {
        const targetElement = event.target;
        const allowedSelectors = [
            '#search-box',
            '#gradient-css-output',
            '#grad-color-1',
            '#grad-color-2'
        ];

        if (allowedSelectors.some(selector => targetElement.matches(selector)) || 
            targetElement.closest('input[type="color"]')) { 
            return; 
        }
        // event.preventDefault(); 
    });


    // --- INITIALIZATION ON WINDOW LOAD ---
    window.onload = () => {
        const savedTheme = localStorage.getItem('theme');
        const initialTheme = savedTheme || (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        applyTheme(initialTheme); 

        if(colorDisplayElement) {
            let initialMessageElement = colorDisplayElement.querySelector('.initial-message');
            if (!initialMessageElement) {
                colorDisplayElement.innerHTML = `<p class="initial-message">${WELCOME_MESSAGE}</p>`;
            } else {
                 initialMessageElement.innerHTML = WELCOME_MESSAGE;
            }
            
            if (colorDatabase.length === 0) {
                const msgElement = colorDisplayElement.querySelector('.initial-message');
                if (msgElement) msgElement.innerHTML = NO_COLORS_IN_DB_MESSAGE;
            } else {
                appendInitialSampleCards();
            }
        }
        
        updateGradientPreviewAndCode(); 

        // Start sky animations
        setInterval(createShootingStar, 3000 + Math.random() * 2000); 
        startSmokeTrail(); 
    };
  </script>
</body>
</html>
